<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Join Death2Data - $1/month</title>
<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
  background: #000;
  color: #fff;
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20px;
}

.container {
  max-width: 600px;
  width: 100%;
  text-align: center;
}

h1 {
  font-size: 48px;
  font-weight: 900;
  letter-spacing: -1px;
  margin-bottom: 20px;
}

.tagline {
  font-size: 18px;
  color: #888;
  margin-bottom: 40px;
  font-weight: 300;
}

.comparison {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
  margin-bottom: 60px;
  text-align: left;
}

.column {
  background: #111;
  border: 1px solid #222;
  padding: 30px;
}

.column h2 {
  font-size: 14px;
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-bottom: 20px;
  font-weight: 600;
}

.column.bad h2 {
  color: #f00;
}

.column.good h2 {
  color: #0f0;
}

.column ul {
  list-style: none;
}

.column li {
  padding: 8px 0;
  font-size: 15px;
  line-height: 1.6;
  color: #aaa;
}

.pricing-box {
  background: #fff;
  color: #000;
  padding: 60px 40px;
  margin-bottom: 40px;
}

.price {
  font-size: 80px;
  font-weight: 900;
  line-height: 1;
  margin-bottom: 10px;
}

.price-label {
  font-size: 18px;
  color: #666;
  margin-bottom: 30px;
}

.cta-button {
  display: inline-block;
  background: #0f0;
  color: #000;
  padding: 20px 60px;
  font-size: 20px;
  font-weight: 700;
  text-decoration: none;
  border: none;
  cursor: pointer;
  transition: transform 0.2s;
}

.cta-button:hover {
  transform: scale(1.05);
}

.cta-button:active {
  transform: scale(0.98);
}

.alt-option {
  margin-top: 20px;
  font-size: 14px;
  color: #888;
}

.alt-option a {
  color: #0f0;
  text-decoration: none;
  border-bottom: 1px solid #0f0;
}

.alt-option a:hover {
  color: #fff;
  border-color: #fff;
}

.fine-print {
  font-size: 14px;
  color: #555;
  margin-top: 40px;
  line-height: 1.8;
}

.fine-print a {
  color: #888;
  text-decoration: none;
}

.fine-print a:hover {
  color: #fff;
}

.support-note {
  background: #111;
  border: 1px solid #222;
  padding: 30px;
  margin-top: 40px;
  text-align: left;
}

.support-note h3 {
  color: #0f0;
  font-size: 16px;
  margin-bottom: 15px;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.support-note p {
  color: #888;
  line-height: 1.8;
  margin-bottom: 15px;
}

.support-tier {
  background: #0a0a0a;
  padding: 15px;
  margin: 10px 0;
  border-left: 2px solid #333;
}

.support-tier:hover {
  border-left-color: #0f0;
}

.support-tier strong {
  color: #fff;
}

.support-tier a {
  color: #0f0;
  text-decoration: none;
  font-size: 13px;
}

@media (max-width: 768px) {
  h1 {
    font-size: 32px;
  }

  .comparison {
    grid-template-columns: 1fr;
  }

  .price {
    font-size: 60px;
  }

  .cta-button {
    padding: 18px 40px;
    font-size: 18px;
  }
}
</style>
</head>
<body>

<div class="container">
  <h1>DEATH2DATA</h1>
  <p class="tagline">Privacy Tools for the Surveilled Age</p>

  <div class="comparison">
    <div class="column bad">
      <h2>What They Take</h2>
      <ul>
        <li>Every search query</li>
        <li>Every location ping</li>
        <li>Every website visit</li>
        <li>Every message sent</li>
        <li>Every photo uploaded</li>
        <li>Every contact saved</li>
        <li>Every preference learned</li>
        <li><strong>Everything. Forever.</strong></li>
      </ul>
    </div>

    <div class="column good">
      <h2>What We Keep</h2>
      <ul>
        <li>No search history</li>
        <li>No location data</li>
        <li>No browsing logs</li>
        <li>No message scanning</li>
        <li>No photo analysis</li>
        <li>No contact harvesting</li>
        <li>No behavioral profiles</li>
        <li><strong>Nothing. By design.</strong></li>
      </ul>
    </div>
  </div>

  <!-- Option 1: Stripe Pricing Table (Recommended) -->
  <!-- Uncomment after creating pricing table in Stripe dashboard -->
  <!--
  <div class="pricing-box" style="background:#0a0a0a;padding:40px 20px;">
    <script async src="https://js.stripe.com/v3/pricing-table.js"></script>
    <stripe-pricing-table
      pricing-table-id="prctbl_YOUR_ID_HERE"
      publishable-key="pk_test_YOUR_KEY_HERE">
    </stripe-pricing-table>
  </div>
  -->

  <!-- Option 2: Manual Buttons (Current) -->
  <div class="pricing-box">
    <div class="price">$1</div>
    <div class="price-label">one-time Â· lifetime access Â· no recurring charges</div>
    <a href="#" class="cta-button" id="cta-onetime">Get Lifetime Access</a>
    <div class="alt-option">
      or support with <a href="#" id="cta-supporter">$10 one-time</a> Â· <a href="#" id="cta-sponsor">$50 sponsor</a>
    </div>
  </div>

  <div class="fine-print">
    Open source. No investors. Built in Florida, USA.<br>
    Questions? <a href="mailto:matt@death2data.com">matt@death2data.com</a>
  </div>

  <div class="support-note">
    <h3>What You Get</h3>
    <p style="margin-bottom:10px;">
      <strong style="color:#0f0;">Private Search</strong> - 3 engines, no tracking<br>
      <strong style="color:#0f0;">Encrypted Notebook</strong> - Client-side storage<br>
      <strong style="color:#0f0;">QR Generators</strong> - WiFi, URLs, contacts<br>
      <strong style="color:#0f0;">Grant Finder</strong> - Find funding for your projects<br>
      <strong style="color:#0f0;">Export Everything</strong> - Your data, your control
    </p>

    <p style="margin-top: 15px; font-size: 13px; color:#666;">
      One-time payment. No subscriptions. No tracking. Lifetime access.
    </p>
  </div>
</div>

<script>
// Load products from Stripe catalog
let catalog = null;
const WORKER_API = 'https://d2d-api.mattmauersp.workers.dev';

async function loadProducts() {
  try {
    const res = await fetch('./products.json');
    catalog = await res.json();
    console.log('âœ… Loaded product catalog:', catalog);

    // Find "Death2Data Lifetime Access" product
    const d2dProduct = catalog.products.find(p => p.name.includes('Death2Data'));

    if (d2dProduct) {
      // Display in-stock status (future feature)
      const inStockCount = d2dProduct.prices.filter(p => p.in_stock).length;
      console.log(`ðŸ“¦ ${inStockCount} prices available`);
    }
  } catch (err) {
    console.error('âŒ Failed to load products:', err);
  }
}

// Create checkout session via Cloudflare Worker
async function checkout(priceId) {
  try {
    console.log('Creating checkout for price:', priceId);

    const res = await fetch(`${WORKER_API}/checkout`, {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({
        priceId,
        successUrl: window.location.origin + '/?payment=success',
        cancelUrl: window.location.href
      })
    });

    const data = await res.json();

    if (data.url) {
      window.location.href = data.url;
    } else {
      throw new Error(data.error || 'Unknown error');
    }
  } catch (err) {
    console.error('Checkout error:', err);
    alert('Payment error. Email matt@death2data.com or try again.');
  }
}

// Get price ID by amount
function getPriceId(amount) {
  if (!catalog) {
    console.error('Catalog not loaded yet');
    return null;
  }

  const d2dProduct = catalog.products.find(p => p.name.includes('Death2Data'));
  if (!d2dProduct) {
    console.error('Death2Data product not found');
    return null;
  }

  const price = d2dProduct.prices.find(p =>
    p.amount_dollars === amount && p.type === 'one_time' && p.in_stock
  );

  return price ? price.id : null;
}

// Button handlers
document.getElementById('cta-onetime').addEventListener('click', (e) => {
  e.preventDefault();
  const priceId = getPriceId(1.0);
  if (priceId) {
    checkout(priceId);
  } else {
    alert('Product unavailable. Email matt@death2data.com');
  }
});

document.getElementById('cta-supporter').addEventListener('click', (e) => {
  e.preventDefault();
  const priceId = getPriceId(10.0);
  if (priceId) {
    checkout(priceId);
  } else {
    alert('Product unavailable. Email matt@death2data.com');
  }
});

document.getElementById('cta-sponsor').addEventListener('click', (e) => {
  e.preventDefault();
  const priceId = getPriceId(50.0);
  if (priceId) {
    checkout(priceId);
  } else {
    alert('Product unavailable. Email matt@death2data.com');
  }
});

// Load products on page load
loadProducts();
</script>

</body>
</html>
